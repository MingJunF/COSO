[2024-04-21 21:00:07,237][__main__][INFO] - 
model:
  dim_treatments: 4
  dim_vitals: 0
  dim_static_features: 1
  dim_outcomes: 1
  dim_cosovitals: ???
  dim_abstract_confounders: ???
  dim_s: ???
  name: CT
  multi:
    _target_: src.models.ct.CT
    max_seq_length: 65
    seq_hidden_units: 16
    br_size: 16
    fc_hidden_units: 48
    dropout_rate: 0.1
    num_layer: 1
    num_heads: 2
    max_grad_norm: null
    batch_size: 128
    attn_dropout: true
    disable_cross_attention: false
    isolate_subnetwork: _
    self_positional_encoding:
      absolute: false
      trainable: true
      max_relative_position: 15
    optimizer:
      optimizer_cls: adam
      learning_rate: 0.001
      weight_decay: 0.0
      lr_scheduler: false
    augment_with_masked_vitals: true
    tune_hparams: Ture
    tune_range: 20
    hparams_grid:
      num_layer:
      - 1
      num_heads:
      - 2
      learning_rate:
      - 0.01
      - 0.001
      - 0.0001
      batch_size:
      - 64
      - 128
      - 256
      seq_hidden_units:
      - 1.0
      - 2.0
      - 3.0
      - 4.0
      br_size:
      - 0.5
      - 1.0
      - 2.0
      - 3.0
      - 4.0
      fc_hidden_units:
      - 0.5
      - 1.0
      - 2.0
      - 3.0
      - 4.0
      dropout_rate:
      - 0.1
      - 0.2
      - 0.3
      - 0.4
      - 0.5
    resources_per_trial:
      cpu: 0.4
      gpu: 0.25
  self_positional_encoding:
    max_relative_position: 15
dataset:
  val_batch_size: 512
  treatment_mode: multiclass
  _target_: src.data.SyntheticVitalDatasetCollection
  name: tumor_generator
  seed: 100
  split:
    val: 0.15
    test: 0.15
  window_size: 15
  lag: 0
  max_seq_length: 60
  projection_horizon: 5
  cf_seq_mode: sliding_treatment
  time_step: 30
  coeff: 0.0
exp:
  seed: 100
  gpus:
  - 0
  max_epochs: 150
  logging: true
  mlflow_uri: http://127.0.0.1:5000
  unscale_rmse: true
  percentage_rmse: true
  alpha: 0.01
  update_alpha: true
  alpha_rate: exp
  balancing: domain_confusion
  bce_weight: false
  weights_ema: true
  beta: 0.99

[2024-04-21 21:00:08,680][src.data.cancer_sim.dataset][INFO] - Shape of processed train data: {'sequence_lengths': (350,), 'prev_treatments': (350, 29, 1), 'vitals': (350, 29, 8), 'next_vitals': (350, 28, 8), 'current_treatments': (350, 29, 1), 'static_features': (350, 1), 'active_entries': (350, 29, 1), 'outputs': (350, 29, 1), 'unscaled_outputs': (350, 29, 1), 'prev_outputs': (350, 29, 1), 'coso_vitals': (350, 29, 7), 'COSO': (350, 29, 1)}
[2024-04-21 21:00:08,680][src.data.cancer_sim.dataset][INFO] - Shape of processed val data: {'sequence_lengths': (75,), 'prev_treatments': (75, 29, 1), 'vitals': (75, 29, 8), 'next_vitals': (75, 28, 8), 'current_treatments': (75, 29, 1), 'static_features': (75, 1), 'active_entries': (75, 29, 1), 'outputs': (75, 29, 1), 'unscaled_outputs': (75, 29, 1), 'prev_outputs': (75, 29, 1), 'coso_vitals': (75, 29, 7), 'COSO': (75, 29, 1)}
[2024-04-21 21:00:08,680][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'sequence_lengths': (75,), 'prev_treatments': (75, 29, 1), 'vitals': (75, 29, 8), 'next_vitals': (75, 28, 8), 'current_treatments': (75, 29, 1), 'static_features': (75, 1), 'active_entries': (75, 29, 1), 'outputs': (75, 29, 1), 'unscaled_outputs': (75, 29, 1), 'prev_outputs': (75, 29, 1), 'coso_vitals': (75, 29, 7), 'COSO': (75, 29, 1)}
[2024-04-21 21:00:08,680][src.data.cancer_sim.dataset][INFO] - Exploding test dataset before testing (multiple sequences)
[2024-04-21 21:00:08,703][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'prev_treatments': (1475, 29, 1), 'current_treatments': (1475, 29, 1), 'static_features': (1475, 1), 'prev_outputs': (1475, 29, 1), 'outputs': (1475, 29, 1), 'vitals': (1475, 29, 8), 'next_vitals': (1475, 28, 8), 'unscaled_outputs': (1475, 29, 1), 'sequence_lengths': (1475,), 'active_entries': (1475, 29, 1)}
[2024-04-21 21:00:08,703][src.data.cancer_sim.dataset][INFO] - Processing test dataset before testing (multiple sequences)
[2024-04-21 21:00:08,717][src.data.cancer_sim.dataset][INFO] - Shape of processed test data: {'original_index': (1475,), 'active_encoder_r': (1475, 24), 'prev_treatments': (1475, 5, 1), 'current_treatments': (1475, 5, 1), 'static_features': (1475, 1), 'prev_outputs': (1475, 5, 1), 'outputs': (1475, 5, 1), 'unscaled_outputs': (1475, 5, 1), 'sequence_lengths': (1475,), 'active_entries': (1475, 5, 1)}
[2024-04-21 21:00:08,948][src.models.ct][INFO] - Max input size of multi: 8
[2024-04-21 21:00:08,970][src.models.time_varying_model][INFO] - Running hyperparameters selection with 20 trials
